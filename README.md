[Suggested description]
An issue was discovered in Opsview Monitor Agent 6.8. An unauthenticated remote attacker can call check_nrpe against affected targets, specifying known NRPE plugins, which in default installations are configured to accept command control characters and pass them to command-line interpreters for NRPE plugin execution. This allows the attacker to escape NRPE plugin execution and execute commands remotely on the target as NT_AUTHORITY\SYSTEM.

------------------------------------------

[Additional Information]
Opsview and the ITRS Group have been informed of the vulnerability, and have released a patch for the Windows Agent "OpsviewAgent version 0.3.9.719 2023-03-09".

------------------------------------------

[VulnerabilityType Other]
Remote Command Execution

------------------------------------------

[Vendor of Product]
Opsview

------------------------------------------

[Affected Product Code Base]
Opsview - Windows Agent "OpsviewAgent 0.3.9.700 2022-09-28" and earlier.
Opsview & ITRS Group - ITRS Agents unaffected

------------------------------------------

[Affected Component]
The Opsview Agent service running on the machine and the NSClient++.exe substrate that runs the NRPE handlers configured by the opsview.ini configuration file.

------------------------------------------

[Impact Code execution]
true

------------------------------------------

[Attack Vectors]
An unauthenticated remote attacker may call check_nrpe against the target, specifying an NRPE plugin that is defined on the target host and is configured to pass arguments to PowerShell.exe or other command line interpreters.

------------------------------------------

[Has vendor confirmed or acknowledged the vulnerability?]
true

------------------------------------------

[Discoverer]
WTHJ

------------------------------------------

[Reference]
https://knowledge.opsview.com/docs/whats-new
